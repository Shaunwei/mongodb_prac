#!/usr/bin/env python
from bson.code import Code

map = Code("function() {"
           "var summary = this.doc;"
             "if (summary) {"
               "summary = summary.toLowerCase().split(" ");"
               "for (var i = summary.length - 1; i >= 0; i--) {"
                 "if (summary[i])  {"
                   "emit(summary[i], 1);"
                 "}"
               "}"
              "}"
           "};")

reduce = Code("function (key, values) {"
              "  var total = 0;"
              "  for (var i = 0; i < values.length; i++) {"
              "    total += values[i];"
              "  }"
              "  return total;"
              "}")

